## Навигация

- [Объект `basicFilter`](#объект-basicfilter)
  - [Методы объекта `basicFilter`](#методы-объекта-basicfilter)
- [Объект `twoLevelFilter`](#объект-twolevelfilter)
  - [Структура объекта `twoLevelFilter`](#структура-объекта-twolevelfilter)
- [Объект `basicPieChart`](#объект-basicpiechart)
  - [Структура объекта `basicPieChart`](#структура-объекта-basicpiechart)
- [Объект `pieChartToggleConfig`](#объект-piecharttoggleconfig)
  - [Структура объекта `pieChartToggleConfig`](#структура-объекта-piecharttoggleconfig)
- [Объект `pieChartWithSwitcher`](#объект-piechartwithswitcher)
  - [Структура объекта `pieChartWithSwitcher`](#структура-объекта-piechartwithswitcher)

---

# Объект `basicFilter`

=============================

Объект `basicFilter` модифицирует и расширяет функционал `FilterRender`

#### Методы объекта `basicFilter`:

1.  `applyCssStyles` _(параметр: `openToRight` по умолчанию false)_

    - Ожидает булево значение, которое определяет, в какую сторону будет раскрываться фильтр. Если истинно, фильтр раскрывается вправо; если ложно, раскрывается влево.
    - Применяет CSS-стили к элементам фильтра.
    - Изменяет цвета стрелок и крестика в заголовке выпадающего меню.
    - Настраивает высоту и ширину выпадающего списка фильтров.
    - Изменяет цвет и скругление контура фильтра.
    - Добавляет стили для изменения цвета иконок чекбоксов.

2.  `setupSelectionButtons`

    - Настраивает кнопки выбора "Выбрать все" и "Сбросить все" в зависимости от количества данных в фильтре.
    - Если данных больше 4, кнопки отображаются с определенными стилями.
    - Если данных меньше или равно 4, кнопки скрываются.

3.  `observeFilterFieldChanges`

    - Обновляет текст заголовка фильтра в зависимости от количества выбранных элементов.
    - Добавляет слушателя, который срабатывает при загрузке виджета, обновляя текст заголовка фильтра на основе выбранных значений.

4.  `initializeFilterSearch`

    - Настраивает функционал поиска в фильтре.
    - Добавляет возможность очистки строки поиска при наличии текста.
    - Меняет стили поля поиска при фокусе и потере фокуса.
    - Сбрасывает строку поиска при закрытии фильтра или отмене выбора.
    - Сохраняет введенное значение в строке поиска и восстанавливает его при повторном открытии фильтра.

5.  `initializeYearFromSystem`

    - Инициализирует выбор года в фильтре на основе текущей системной даты.
    - Сравнивает доступные значения фильтра: если текущий год присутствует среди них, выбирает его; если нет, устанавливает предыдущий год.
    - Сохраняет информацию о выборе года в `localStorage` для предотвращения повторной установки при последующих загрузках.

### Пример использования

```javascript
let width = 400; // Ширина выпадающего списка виджета. Если 0 - остается неизменной.
let height = 200; // Высота выпадающего списка виджета. Если 0 - остается неизменной.
let widget = $('#' + w.general.renderTo);

FilterRender({
  filter: w.general,
  style: w.style,
  textStyle: w.textStyle,
  data: w.data
});

basicFilter.applyCssStyles();
basicFilter.observeFilterFieldChanges();
basicFilter.initializeFilterSearch();
basicFilter.setupSelectionButtons();`
```

# Объект `twoLevelFilter`

=============================

Объект `twoLevelFilter` реализует функциональность фильтрации данных с использованием двухуровневого дерева (tree view). Этот код позволяет пользователю выбирать значения из иерархической структуры данных, а также управлять выбранными значениями через интерфейс.

## Структура объекта `twoLevelFilter`

#### Свойства

- `selectedValues`: Массив выбранных значений.
- `dataSource`: Исходные данные для построения дерева.
- `dxTreeView`: Экземпляр компонента DevExpress для отображения дерева.

#### Методы

1.  `createList(listData, chainMeasure)`

    - Создает иерархический список на основе входных данных `listData`.
    - Параметры:
      - `listData`: Массив данных для фильтрации.
      - `chainMeasure`: Массив для хранения текущего уровня фильтрации.
    - Возвращает `dataSource` - массив объектов, представляющих элементы дерева.

2.  `addSelectedValues(values)`

    - Добавляет выбранные значения в выпадающий список "Выбранные значения".
    - Параметры:
      - `values`: Массив значений для добавления.
    - Обновляет визуальное представление выбранных значений в фильтре.

3.  `renderFilter()`

    - Инициализирует и отображает фильтр.
    - Получает выбранные значения и создает дерево на основе исходных данных.

4.  `getSelectValues()`

    - Проходит по всем элементам дерева и собирает идентификаторы.
    - Возвращает массив идентификаторов выбранных значений.

5.  `deleteSelectedValues(elem)`

    - Удаляет выбранное значение из выпадающий список "Выбранные значения".
    - Параметры:
      - `elem`: Элемент DOM, который нужно удалить.

6.  `filterInit(filter)`

    - Инициализирует фильтр с заданными значениями.
    - Параметры:
      - `filter`: Объект с параметрами фильтрации.

7.  `syncSelection(check)`

    - Синхронизирует выбор элементов в дереве с выбранными значениями.
    - Параметры:
      - `check`: Указывает, нужно ли сбрасывать выбор.

8.  `removeInitialList()`

    - Убирает начальный список элементов с анимацией.

9.  `createElements()`

    - Создает элементы интерфейса для фильтра, включая кнопки и поля ввода.

10. `removeItems()`

    - Удаляет все элементы интерфейса, связанные с фильтром.

11. `createButtons()`

    - Создает кнопки для выбора и сброса всех значений.

12. `applyCssStyle()`

    - Применяет стили к элементам интерфейса.

13. `addTextInput(selectedRegions)`

    - Обновляет текст заголовка фильтра на основе выбранных значений.
    - Параметры:
      - `selectedRegions`: Массив выбранных значений.

14. `regionFilter(allRegions, regions, index)`

    - Фильтрует массив всех значений на основе выбранных значений.
    - Параметры:
      - `allRegions`: Массив всех значений.
      - `regions`: Массив выбранных значений.
      - `index`: Индекс текущего значения.

15. `getAllSelectRegions()`

    - Возвращает массив всех выбранных значений.

16. `calculateHeight(height)`

    - Рассчитывает высоту элемента на основе переданного значения.
    - Параметры:
      - `height`: Высота, которую нужно установить.
    - Возвращает строку с высотой.

### Пример использования

```javascript
const width = 600; // Ширина выпадающего списка виджета. Если 0 - остается неизменна
const height = 0; // Высота выпадающего списка виджета. Если 0 - остается неизменна
var listPosition = "left"; // Выравнивание выпадающего списка right или left
const widgetId = $("#widget-" + w.general.renderTo);
const widget = $("#" + w.general.renderTo);
let isCheckedInclude = true;

twoLevelFilter.renderFilter();
```

# Объект `basicPieChart`

=============================

Объект `basicPieChart` реализует функциональность для работы с круговыми диаграммами (pie charts) в приложении. Он предоставляет методы для управления отображением элементов диаграммы, обработки событий и настройки визуальных параметров.

## Структура объекта `basicPieChart`

### Методы

1.  `removeItems()`

    - Удаляет все элементы, связанные с круговой диаграммой.

2.  `checkEnabledLegendItem(selectedValues)`

    - Проверяет, есть ли скрытые элементы легенды или выбранные значения, и отображает или скрывает кнопку фильтра.
    - Параметры:
      - `selectedValues`: Количество выбранных значений (по умолчанию 0).

3.  `updateTextSize()`

    - Обновляет размер текста в зависимости от того, находится ли виджет в режиме увеличения (zoom).

4.  `legendHandler()`

    - Обрабатывает клики по элементам легенды и сохраняет состояние скрытых элементов в localStorage.

5.  `setHiddenItem()`

    - Устанавливает скрытые элементы в диаграмме на основе данных из localStorage.

6.  `fadeData()`

    - Устанавливает прозрачность данных на диаграмме в зависимости от выбранного элемента.

7.  `unclickAll()`

    - Снимает выделение со всех элементов диаграммы, кроме текущего.

# Объект `pieChartToggleConfig`

=============================

Объект `pieChartToggleConfig` расширяет функциональность объекта `basicPieChart`, добавляя/переопределяя методы для управления видимостью элементов легенды и работы с данными круговой диаграммы. Он позволяет активировать и деактивировать элементы легенды, а также управлять их состоянием через localStorage.

## Структура объекта `pieChartToggleConfig`

### Методы

1.  `removeLocalStorageValue(value)`

    - Удаляет значение из localStorage для заданного фильтра.
    - Параметры:
      - `value`: Значение, которое нужно удалить. Если не указано, используется значение по умолчанию ("Цена").

2.  `activeHiddenItem()`

    - Активирует скрытые элементы легенды на диаграмме на основе данных из localStorage.

3.  `legendHandler(value)`

    - Обрабатывает клики по элементам легенды и сохраняет состояние скрытых элементов в localStorage.
    - Параметры:
      - `value`: Значение фильтра, которое будет использоваться для сохранения скрытых элементов.

4.  `setHiddenItem(flag, value)`

    - Устанавливает скрытые элементы на диаграмме на основе данных из localStorage.
    - Параметры:
      - `flag`: Указывает, нужно ли отменить событие (по умолчанию `true`).
      - `value`: Значение фильтра, по которому будут установлены скрытые элементы.

5.  `updateDataWithCategories(seriesData)`

    - Обновляет данные серии, добавляя индексы легенды и цвета на основе категорий.
    - Параметры:
      - `seriesData`: Данные серии для обновления.
    - Возвращает обновленные данные.

6.  `sortArrayBasedOnAnother(sorted, notSorted)`

    - Сортирует массив `notSorted` на основе порядка элементов в массиве `sorted`.
    - Параметры:
      - `sorted`: Массив отсортированных элементов.
      - `notSorted`: Массив, который нужно отсортировать.
    - Возвращает отсортированный массив.

7.  `sortedSeries(series)`

    - Сортирует данные серии по убыванию значений `y`, игнорируя значения `NaN`.
    - Параметры:
      - `series`: Данные серии для сортировки.
    - Возвращает отсортированные данные серии.

# Объект `pieChartWithSwitcher`

=============================

Объект `pieChartWithSwitcher` предоставляет функциональность для управления переключателем (switcher), который позволяет пользователю выбирать между двумя значениями. Он взаимодействует с круговой диаграммой и обновляет данные в соответствии с состоянием переключателя.

## Структура объекта `pieChartWithSwitcher`

### Методы

1.  `switcherHandler(e, firstValue, secondValue)`

    - Обрабатывает изменения состояния переключателя и обновляет диаграмму в зависимости от выбранного значения.
    - Параметры:
      - `e`: Событие изменения состояния переключателя.
      - `firstValue`: Значение, которое будет выбрано, если переключатель включен.
      - `secondValue`: Значение, которое будет выбрано, если переключатель выключен.

2.  `addSwitcher(selector, firstValue, secondValue)`

    - Создает и добавляет переключатель в указанный контейнер на странице.
    - Параметры:
      - `selector`: CSS-селектор контейнера, в который будет добавлен переключатель.
      - `firstValue`: Значение, соответствующее состоянию включенного переключателя.
      - `secondValue`: Значение, соответствующее состоянию выключенного переключателя.

# Объект `pieChartWithDrilldown`

=============================

Объект `pieChartWithDrilldown` предоставляет функциональность для управления состоянием зума и взаимодействия с элементами легенды в круговой диаграмме с возможностью детализации (drilldown). Он позволяет пользователю управлять режимом зума и проверять наличие скрытых элементов легенды.

## Структура объекта `pieChartWithDrilldown`

### Методы

1.  `toggleIsZoom(value)`

    - Переключает состояние зума. Если значение не указано, состояние зума изменяется на противоположное.
    - Параметры:
      - `value`: (необязательный) Новое состояние зума. Если не указано, состояние будет переключено.

2.  `getIsZoom()`

    - Возвращает текущее состояние зума.
    - Возвращает:
      - `boolean`: `true`, если зум включен; `false`, если выключен.

3.  `checkEnabledLegendItem(condition)`

    - Проверяет наличие скрытых элементов легенды и обновляет видимость кнопки фильтра в зависимости от условий.
    - Параметры:
      - `condition`: Условие для проверки (не используется в текущей реализации, но может быть добавлено для расширения функциональности).

# Объект `barChart`

=============================

Объект `barChart` предоставляет методы для управления элементами столбчатой диаграммы, включая удаление элементов, создание заголовков, адаптацию меток осей, настройку стилей и сохранение значений в localStorage.

## Структура объекта `barChart`

### Методы

1.  `removeItems()`

    - Удаляет элементы диаграммы, такие как зум и заголовки, из DOM.

2.  `createTitleLabel(type)`

    - Создает и добавляет заголовок к диаграмме в зависимости от типа.
    - Параметры:
      - `type`: Строка, представляющая тип заголовка.

3.  `convertAxisAdaptiveLabel(value, max, type)`

    - Преобразует метку оси в зависимости от максимального значения и создает соответствующий заголовок.
    - Параметры:
      - `value`: Значение, для которого создается метка.
      - `max`: Максимальное значение для адаптации метки.
      - `type`: Тип метки, который будет добавлен к заголовку.

4.  `vidgetStyle()`

    - Устанавливает стиль шрифта для различных элементов диаграммы на "Roboto".

5.  `saveValues(value, key)`

    - Сохраняет значение в localStorage под указанным ключом.
    - Параметры:
      - `value`: Значение, которое нужно сохранить.
      - `key`: Ключ, под которым будет сохранено значение.

6.  `removeValues(value, key)`

    - Удаляет значение из localStorage под указанным ключом.
    - Параметры:
      - `value`: Значение, которое нужно удалить.
      - `key`: Ключ, из которого будет удалено значение.

# Объект `columnChart`

=============================

Объект `columnChart` является расширением объекта `barChart`, предоставляя дополнительный метод для перерасчета левого отступа диаграммы в зависимости от ширины меток оси Y.

## Структура объекта `columnChart`

### Методы

1.  `recalculateLeftMargin()`

    - Перерасчитывает левый отступ диаграммы на основе ширины меток оси Y. Если ширина меток слишком мала или велика, отступ будет скорректирован.
    - Обновляет параметры диаграммы с новым значением левого отступа.

# Объект `tableBasicChart`

=============================

Объект `tableBasicChart` предоставляет методы для управления таблицей, включая сортировку столбцов, отображение сообщений об ошибках, изменение стилей и значений, а также обработку данных в таблице. Этот объект предназначен для работы с таблицами, созданными с использованием библиотеки DevExtreme.

## Структура объекта `tableBasicChart`

### Методы

1.  `addSortArrow()`

    - Добавляет стрелки сортировки к заголовкам столбцов таблицы.
    - Создает элементы стиля для отображения стрелок вверх и вниз.
    - Добавляет кнопки сортировки в каждый столбец.
    - Устанавливает обработчик события для сортировки при нажатии на стрелку.

2.  `removeItems()`

    - Удаляет элементы таблицы, такие как кнопка экспорта и зум.

3.  `hideSpiner()`

    - Скрывает индикатор загрузки, если данные не загрузились.

4.  `removeStyles()`

    - Удаляет стили, связанные с таблицей.

5.  `hideTableOnLoad()`

    - Устанавливает стиль для скрытия таблицы во время загрузки данных.

6.  `changeValueToDate(rowData)`

    - Преобразует значения в формате даты в дочерних элементах указанного узла.
    - Параметры:
      - `rowData`: Узел, содержащий данные, которые нужно преобразовать.

7.  `getValue(node)`

    - Получает значение узла, рекурсивно проверяя дочерние элементы.
    - Параметры:
      - `node`: Узел, из которого нужно получить значение.
    - Возвращает:
      - `string`: Значение узла.

8.  `setValue(node, value)`

    - Устанавливает значение узла, рекурсивно проверяя дочерние элементы.
    - Параметры:
      - `node`: Узел, в который нужно установить значение.
      - `value`: Значение, которое нужно установить.

9.  `showMessage()`

    - Отображает сообщение об ошибке, если нет данных, удовлетворяющих условиям фильтрации.

10. `customizingStyles(shouldChangeWidth, enableMeasurement = true)`

    - Настраивает стили таблицы и перезагружает данные.
    - Параметры:
      - `shouldChangeWidth`: Указывает, нужно ли изменять ширину.
      - `enableMeasurement`: Указывает, нужно ли включать измерение ширины (по умолчанию `true`).

11. `measurementColumnWidth()`

    - Настраивает ширину ячеек таблицы в зависимости от значений.

12. `changeWidth()`

    - Изменяет ширину таблицы и ячеек.

13. `sort(columnsValId, columnsYearId)`

  - Метод сортирует данные в таблице по указанному столбцу и году. Он использует алгоритм пузырьковой сортировки для упорядочивания строк на основе значений в выбранном столбце и году. Метод также обновляет направление сортировки (по возрастанию или убыванию) после выполнения сортировки.
    - Параметры:
      - `columnsValId` (`number`): Индекс столбца, по которому будет производиться сортировка.
      - `columnsYearId` (`number`): Индекс года, по которому будет производиться сортировка.
    - Примечания:
      - Метод использует вспомогательные функции `_findDeepIndex`, `_findNodesWithMultipleChildren` и `_bubbleSort` для выполнения сортировки.
      - Направление сортировки меняется между "max" и "min" после каждого вызова метода.

14. `toogleClassArrowSort(columnsValId)`

  - Метод переключает класс стрелки сортировки для указанного столбца. В зависимости от текущего направления сортировки (вверх или вниз), он обновляет класс элемента, отображающего стрелку сортировки.
    - Параметры:
      - `columnsValId` (`number`): Индекс столбца, для которого нужно переключить класс стрелки сортировки.

15. `checkValues(values)`

  - Метод проверяет массив значений и определяет, содержат ли все значения пустые строки или нули. Он возвращает `true`, если все значения соответствуют этому условию, и `false` в противном случае.
    - Параметры:
      - `values` (`Array`): Массив значений, который нужно проверить. Каждый элемент массива ожидает, что будет массив, где первый элемент является проверяемым значением.

